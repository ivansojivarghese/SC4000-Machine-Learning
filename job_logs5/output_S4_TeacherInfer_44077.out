[Step4] SAVE_ROOT=/scratch-shared/tc1proj005/folds FOLDS=[0] MODELS=['llama'] SAVE_LASTTOK=False TOPK=0
[Step4] Sharding enabled: shard_id=4 of 5 strategy=range suffix='_sh4-of-5' WRITE_ENSEMBLE=False
[Step4] MAX_SEQ_LEN=768 FUSED_PAIRS=True PAD_TO_MULT=8 SAVE_LOGPROBS=False
[Step4] Loaded data/fold_data/fold_0_train.csv rows=59505 cols=9
[Step4][Shard] Fold 0: range strategy rows 47604:59505 -> 11901/59505.
[Step4] Loaded data/fold_data/fold_0_val.csv rows=19159 cols=9
[Step4] Loading llama fold 0 from LoRA /scratch-shared/tc1proj005/folds/llama_fold_0_lora + base /scratch-shared/tc1proj005/post_pretrain_llama3-8b_merged
[Step4][Info] Tokenizer source for llama fold 0: /scratch-shared/tc1proj005/folds/llama_fold_0_lora
[Step4][Info] Accelerate device_map detected; skipping explicit model.to().
[Step4][Subset] llama fold 0: requested 50000 > available 11901. Using full set.
[Step4][Debug] Preparing last-token repr on 11901 texts (SAVE_LASTTOK=False)
[Step4][Debug] Starting TRAIN log-likelihood (N=11901), batch_size=8, progress_every=50
[Step4] Using batched loglik batch_size=8 fused=True progress_every=50
[Step4][Progress] Fused batch 8/11901 (2.14 ex/s) elapsed=0.1m
[Step4][Progress] Fused batch 408/11901 (2.55 ex/s) elapsed=2.7m
[Step4][Progress] Fused batch 808/11901 (2.56 ex/s) elapsed=5.3m
[Step4][Progress] Fused batch 1208/11901 (2.53 ex/s) elapsed=8.0m
[Step4][Progress] Fused batch 1608/11901 (2.53 ex/s) elapsed=10.6m
[Step4][Progress] Fused batch 2008/11901 (2.53 ex/s) elapsed=13.3m
[Step4][Progress] Fused batch 2408/11901 (2.55 ex/s) elapsed=15.7m
[Step4][Progress] Fused batch 2808/11901 (2.56 ex/s) elapsed=18.3m
[Step4][Progress] Fused batch 3208/11901 (2.54 ex/s) elapsed=21.0m
[Step4][Progress] Fused batch 3608/11901 (2.54 ex/s) elapsed=23.7m
[Step4][Progress] Fused batch 4008/11901 (2.53 ex/s) elapsed=26.4m
[Step4][Progress] Fused batch 4408/11901 (2.52 ex/s) elapsed=29.2m
[Step4][Progress] Fused batch 4808/11901 (2.53 ex/s) elapsed=31.7m
[Step4][Progress] Fused batch 5208/11901 (2.53 ex/s) elapsed=34.3m
[Step4][Progress] Fused batch 5608/11901 (2.55 ex/s) elapsed=36.7m
[Step4][Progress] Fused batch 6008/11901 (2.55 ex/s) elapsed=39.3m
[Step4][Progress] Fused batch 6408/11901 (2.55 ex/s) elapsed=41.9m
[Step4][Progress] Fused batch 6808/11901 (2.54 ex/s) elapsed=44.6m
[Step4][Progress] Fused batch 7208/11901 (2.53 ex/s) elapsed=47.4m
[Step4][Progress] Fused batch 7608/11901 (2.53 ex/s) elapsed=50.2m
[Step4][Progress] Fused batch 8008/11901 (2.52 ex/s) elapsed=52.9m
[Step4][Progress] Fused batch 8408/11901 (2.52 ex/s) elapsed=55.7m
[Step4][Progress] Fused batch 8808/11901 (2.51 ex/s) elapsed=58.4m
[Step4][Progress] Fused batch 9208/11901 (2.51 ex/s) elapsed=61.2m
[Step4][Progress] Fused batch 9608/11901 (2.50 ex/s) elapsed=64.0m
[Step4][Progress] Fused batch 10008/11901 (2.50 ex/s) elapsed=66.7m
[Step4][Progress] Fused batch 10408/11901 (2.50 ex/s) elapsed=69.4m
[Step4][Progress] Fused batch 10808/11901 (2.50 ex/s) elapsed=72.0m
[Step4][Progress] Fused batch 11208/11901 (2.50 ex/s) elapsed=74.8m
[Step4][Progress] Fused batch 11608/11901 (2.50 ex/s) elapsed=77.2m
[Step4] Saved tensor -> model_save/teacher_logits/llama_fold_0_train_probs_sh4-of-5.pt shape=(11901, 3)
[Step4] Per-model/fold inference done.
[Step4][OOF] Table -> model_save/teacher_logits/oof_probs_sh4-of-5.parquet rows=11901
[Step4] Finished.
[Step4] Done
